const express = require("express");
const axios = require("axios");
const bodyParser = require("body-parser");

const app = express();
app.use(bodyParser.urlencoded({ extended: true }));

const LINE_TOKEN = "QW/icGO7rhj1Cj9SNmXR3p7s5nkMAF96mPQysowHI8IP82GIJGwsYFAb7MLSOYnGh5MnVH3kfsRnwGNTGYsGusYqXyflSiTGZNLvp5ZgJRA+2uOkfgqBAZQEmoxSmU9C9vVNimHrd5cv06hFqx4OxgdB04t89/1O/w1cDnyilFU=";
const GROUP_ID = "Cc837fbbf35a2236b9e441373f7639958
";

app.post("/report", async (req, res) => {
  const { type, detail, place, name } = req.body;

  const message = `
ðŸš¨ à¹à¸ˆà¹‰à¸‡à¹€à¸«à¸•à¸¸ / à¸‚à¸­à¸‡à¸«à¸²à¸¢à¹ƒà¸™à¹‚à¸£à¸‡à¹€à¸£à¸µà¸¢à¸™
ðŸ“Œ à¸›à¸£à¸°à¹€à¸ à¸—: ${type}
ðŸ§¾ à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”: ${detail}
ðŸ“ à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆ: ${place}
ðŸ‘¤ à¸œà¸¹à¹‰à¹à¸ˆà¹‰à¸‡: ${name}
  `;

  await axios.post(
    "https://api.line.me/v2/bot/message/push",
    {
      to: GROUP_ID,
      messages: [{ type: "text", text: message }]
    },
    {
      headers: {
        Authorization: `Bearer ${LINE_TOKEN}`,
        "Content-Type": "application/json"
      }
    }
  );

  res.send("à¸ªà¹ˆà¸‡à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸‚à¹‰à¸² LINE à¹à¸¥à¹‰à¸§ âœ…");
});

app.listen(3000, () => {
  console.log("Server running on port 3000");
});
